#!/usr/bin/env python
import pybingham
import numpy as np


X = np.array([[0.8776, 0, 0, -0.4794],
              [0.8752, 0, 0, -0.4838],
              [0.8727, 0, 0, -0.4882],
              [0.8703, 0, 0, -0.4925],
              [0.8678, 0, 0, -0.4969],
              [0.8653, 0, 0, -0.5012],
              [0.8628, 0, 0, -0.5055],
              [0.8603, 0, 0, -0.5098],
              [0.8577, 0, 0, -0.5141],
              [0.8551, 0, 0, -0.5184],
              [0.8525, 0, 0, -0.5227],
              [0.8499, 0, 0, -0.5269],
              [0.8473, 0, 0, -0.5312],
              [0.8446, 0, 0, -0.5354],
              [0.8419, 0, 0, -0.5396],
              [0.8392, 0, 0, -0.5438],
              [0.8365, 0, 0, -0.5480],
              [0.8337, 0, 0, -0.5522],
              [0.8309, 0, 0, -0.5564],
              [0.8281, 0, 0, -0.5605],
              [0.8253, 0, 0, -0.5646],
              [0.8225, 0, 0, -0.5688],
              [0.8196, 0, 0, -0.5729],
              [0.8168, 0, 0, -0.5770],
              [0.8139, 0, 0, -0.5810],
              [0.8110, 0, 0, -0.5851],
              [0.8080, 0, 0, -0.5891],
              [0.8051, 0, 0, -0.5932],
              [0.8021, 0, 0, -0.5972],
              [0.7991, 0, 0, -0.6012],
              [0.7961, 0, 0, -0.6052],
              [0.7930, 0, 0, -0.6092],
              [0.7900, 0, 0, -0.6131],
              [0.7869, 0, 0, -0.6171],
              [0.7838, 0, 0, -0.6210],
              [0.7807, 0, 0, -0.6249],
              [0.7776, 0, 0, -0.6288],
              [0.7744, 0, 0, -0.6327],
              [0.7712, 0, 0, -0.6365],
              [0.7681, 0, 0, -0.6404],
              [0.7648, 0, 0, -0.6442],
              [0.7616, 0, 0, -0.6480],
              [0.7584, 0, 0, -0.6518],
              [0.7551, 0, 0, -0.6556],
              [0.7518, 0, 0, -0.6594],
              [0.7485, 0, 0, -0.6631],
              [0.7452, 0, 0, -0.6669],
              [0.7418, 0, 0, -0.6706],
              [0.7385, 0, 0, -0.6743],
              [0.7351, 0, 0, -0.6780],
              [0.7317, 0, 0, -0.6816],
              [0.7283, 0, 0, -0.6853],
              [0.7248, 0, 0, -0.6889],
              [0.7214, 0, 0, -0.6925],
              [0.7179, 0, 0, -0.6961],
              [0.7144, 0, 0, -0.6997],
              [0.7109, 0, 0, -0.7033],
              [0.7074, 0, 0, -0.7068],
              [0.7038, 0, 0, -0.7104],
              [0.7003, 0, 0, -0.7139],
              [0.6967, 0, 0, -0.7174],
              [0.6931, 0, 0, -0.7208],
              [0.6895, 0, 0, -0.7243],
              [0.6859, 0, 0, -0.7277],
              [0.6822, 0, 0, -0.7311],
              [0.6786, 0, 0, -0.7345],
              [0.6749, 0, 0, -0.7379],
              [0.6712, 0, 0, -0.7413],
              [0.6675, 0, 0, -0.7446],
              [0.6637, 0, 0, -0.7480],
              [0.6600, 0, 0, -0.7513],
              [0.6562, 0, 0, -0.7546],
              [0.6524, 0, 0, -0.7578],
              [0.6486, 0, 0, -0.7611],
              [0.6448, 0, 0, -0.7643],
              [0.6410, 0, 0, -0.7675],
              [0.6372, 0, 0, -0.7707],
              [0.6333, 0, 0, -0.7739],
              [0.6294, 0, 0, -0.7771],
              [0.6255, 0, 0, -0.7802],
              [0.6216, 0, 0, -0.7833],
              [0.6177, 0, 0, -0.7864],
              [0.6137, 0, 0, -0.7895],
              [0.6098, 0, 0, -0.7926],
              [0.6058, 0, 0, -0.7956],
              [0.6018, 0, 0, -0.7986],
              [0.5978, 0, 0, -0.8016],
              [0.5938, 0, 0, -0.8046],
              [0.5898, 0, 0, -0.8076],
              [0.5857, 0, 0, -0.8105],
              [0.5817, 0, 0, -0.8134],
              [0.5776, 0, 0, -0.8163],
              [0.5735, 0, 0, -0.8192],
              [0.5694, 0, 0, -0.8220],
              [0.5653, 0, 0, -0.8249],
              [0.5612, 0, 0, -0.8277],
              [0.5570, 0, 0, -0.8305],
              [0.5529, 0, 0, -0.8333],
              [0.5487, 0, 0, -0.8360],
              [0.5445, 0, 0, -0.8388],
              [0.5403, 0, 0, -0.8415]], dtype=np.float64)

v1 = np.array([0,1,0,0], dtype=np.double)
v2 = np.array([0,0,1,0], dtype=np.double)
v3 = np.array([0,0,0,1], dtype=np.double)
b1 = pybingham.Bingham(v1, v2, v3, -1, -2, -3)
b2 = pybingham.Bingham()
b2.fit(X)

print("B1 PDF", b1.pdf(np.array([1,0,0,0], dtype=np.double)))
print("B2 PDF", b2.pdf(np.array([1,0,0,0], dtype=np.double)))
print("CE", pybingham.bingham_cross_entropy(b1, b2))
print("KL", pybingham.bingham_kl_divergence(b1, b2))
print("ENTROPY", b1.entropy)
print("MODE", b1.mode)
print("3 SAMPLES:", b1.sample(3))

print("DONE")
